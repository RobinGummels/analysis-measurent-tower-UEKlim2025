---
title: "Auswertung Temperatur- und Feuchtigkeits-Daten 18.11.2025-09.12.2025"
author: "Robin Gummels, Humam Hikmat, Lenn Kruck"
format: 
  revealjs: 
    theme: dark
    self-contained: true
editor: visual
---

# Wir haben unsere Auswertung mit R gemacht

## Was ist R?
- Open-Source Programmiersprache speziell für Statistik und Datenanalyse
- Bringt tausende Pakete für Auswertung, Visualisierung und Reproduzierbarkeit mit
- Funktioniert interaktiv (Konsole/RStudio) und in Skripten für reproduzierbare Workflows
- Läuft auf allen gängigen Betriebssystemen und ist frei verfügbar

## Warum R?
- Saubere Trennung von Code, Daten und Ergebnis: Analysen bleiben nachvollziehbar
- Starke Visualisierung (z.B. `ggplot2`) für schnelle Diagramme unserer Messdaten
- Große Community und Dokumentation; Probleme sind meist schon gelöst
- Passt gut zu Quarto: Text, Code und Grafiken in einer präsentation kombinierbar

## Slide 2

When you click the **Render** button a document will be generated that includes:

-   Content authored with markdown
-   Output from executable code

## Slide 3 mit Code 1

When you click the **Render** button a presentation will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
#| echo: true
1 + 1
```

## Daten einlesen - Steinfurter Straße
<details>
<summary>Code</summary>
```{r}
#| echo: true 
#| message: true

# Header aus erster Zeile auslesen
csv_headers = read.csv2(file = "data/data-as-csv/metMastSteinfurterStr.csv", 
                        header = FALSE, nrows = 1, as.is = TRUE)

# Daten ab Zeile 6 einlesen mit den Header-Namen
data <- read.csv2(
  "data/data-as-csv/metMastSteinfurterStr.csv",
  skip = 5,
  header = FALSE,
  dec = ","
)
colnames(data) <- csv_headers
```
</details>

```{css, echo=FALSE}
/* Schriftgröße VOR der DT-Berechnung setzen */
.dataTables_wrapper {
  font-size: 11px !important;
}
.dataTables_wrapper table thead th {
  font-size: 10px !important;
  padding: 3px 5px !important;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
}
.dataTables_wrapper table tbody td {
  font-size: 11px !important;
  padding: 2px 4px !important;
}
```

```{r}
DT::datatable(
  data,
  options = list(
    scrollY = "350px",
    scrollX = TRUE,
    pageLength = 50,
    searching = FALSE,
    paging = FALSE,
    info = FALSE,
    autoWidth = FALSE,
    columnDefs = list(
      list(width = "90px", targets = 0),  # Zeitstempel etwas breiter
      list(width = "60px", targets = "_all")  # Alle anderen schmal
    ),
    initComplete = htmlwidgets::JS(
      "function(settings, json) {",
      "  this.api().columns.adjust();",
      "}"
    )
  ),
  class = "compact cell-border stripe",
  style = "bootstrap"
)
```

## Absolute Feuchte - Theorie {.smaller}

::: {.columns}
::: {.column width="50%"}
**Formel:**
$$a = \frac{e \cdot 100}{R_w \cdot T}$$

| Symbol | Bedeutung | Einheit |
|--------|-----------|---------|
| $a$ | Absolute Feuchte | kg·m⁻³ |
| $e$ | Dampfdruck | hPa |
| $R_w$ | Gaskonstante H₂O | 461,5 J/(kg·K) |
| $T$ | Lufttemperatur | K |
:::

::: {.column width="50%"}
**Dampfdruck aus rel. Feuchte:**
$$e = \frac{RH}{100} \cdot e_s$$

**Sättigungsdampfdruck (Magnus):**
$$e_s = 6{,}112 \cdot e^{\frac{17{,}67 \cdot T_C}{T_C + 243{,}5}}$$
:::
:::

## Absolute Feuchte - Berechnung

<details>
<summary>Code</summary>
```{r}
#| echo: true
#| warning: false

# Spezifische Gaskonstante für Wasserdampf [J/(kg·K)]
Rw <- 461.5

# Temperatur und rel. Feuchte aus den korrekten Spalten
temperatur <- data$`Durschnittl. Lufttemperatur [°C]`
rel_feuchte <- data$`Durschnittl. rel. Luftfeuchtigkeit [%]`

# Temperatur in Kelvin umrechnen
T_kelvin <- temperatur + 273.15

# Sättigungsdampfdruck nach Magnus-Formel [hPa]
es <- 6.112 * exp((17.67 * temperatur) / (temperatur + 243.5))

# Aktueller Dampfdruck [hPa]
e <- (rel_feuchte / 100) * es

# Absolute Feuchte [kg/m³]
# Formel: a = (e * 100) / (Rw * T)
# Faktor 100: Umrechnung hPa -> Pa
data$absolute_feuchte <- (e * 100) / (Rw * T_kelvin)

# Zeitstempel konvertieren
data$Zeit <- as.POSIXct(data$Zeitstempel, format = "%d.%m.%Y %H:%M")
```
</details>
```{r}
#| echo: true
summary(data$absolute_feuchte)
```

## Absolute Feuchte - Zeitreihe

<details>
<summary>Code</summary>
```{r}
#| echo: true
#| fig-width: 10
#| fig-height: 5.5

library(ggplot2)

ggplot(data, aes(x = Zeit, y = absolute_feuchte)) +
  geom_line(color = "#00BFC4", linewidth = 0.5) +
  labs(
    title = "Absolute Feuchte - Steinfurter Straße",
    subtitle = "Zeitraum: 18.11.2025 - 09.12.2025",
    x = "Datum",
    y = expression("Absolute Feuchte [kg m"^{-3}*"]"),
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(color = "gray60"),
    axis.title = element_text(face = "bold"),
    panel.grid.minor = element_blank()
  ) +
  scale_x_datetime(date_labels = "%d.%m", date_breaks = "3 days")
```
</details>
```{r}
#| echo: false
#| fig-width: 10
#| fig-height: 5.5

library(ggplot2)

ggplot(data, aes(x = Zeit, y = absolute_feuchte)) +
  geom_line(color = "#00BFC4", linewidth = 0.5) +
  labs(
    title = "Absolute Feuchte - Steinfurter Straße",
    subtitle = "Zeitraum: 18.11.2025 - 09.12.2025",
    x = "Datum",
    y = expression("Absolute Feuchte [kg m"^{-3}*"]"),
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(color = "gray60"),
    axis.title = element_text(face = "bold"),
    panel.grid.minor = element_blank()
  ) +
  scale_x_datetime(date_labels = "%d.%m", date_breaks = "3 days")
```